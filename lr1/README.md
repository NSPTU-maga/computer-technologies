# Лабораторная работа №1  
Алгоритмы и структуры данных для работы с конечноэлементными сетками  
(расчётная область - квадрант окружности)

## Цель работы

Изучить структуры данных метода конечных элементов и способы хранения информации о сетке.  
Реализовать алгоритм построения двумерной конечной сетки в расчётной области.

## Алгоритм построения сетки

> - задание квадрата с обычной прямоугольной сеткой, лежащего в прямом углу квадранта окружности;
> - на дуге окружности расставляется столько же узлов, сколько принадлежит двум сторонам квадрата;
> - соответствующие узлы квадрата и дуги соединяются отрезками;
> - на этих отрезках с заданным коэффициентом разрядки ```spacing``` расставляется заданное число узлов ```n_radial_div```;
> - последовательно сединяем соответствующие узлы отрезков.

![Пример расчётной области](./docs/Снимок%20экрана%202025-12-03%20135353.png)

## Формат входных файлов

### Описание расчётной области — `computational_domain.txt`

Файл задаёт геометрию внутреннего квадрата, радиус окружности и координатные линии:

```text
radius R square_size a
Kx Ky
x[1,1] y[1,1]   x[1,2] y[1,2]   ...   x[1,Kx] y[1,Kx]
x[2,1] y[2,1]   x[2,2] y[2,2]   ...   x[2,Kx] y[2,Kx]
...
x[Ky,1] y[Ky,1] ...             ...   x[Ky,Kx] y[Ky,Kx]
No
m[1] nxb[1] nxe[1] nyb[1] nye[1]
m[2] nxb[2] nxe[2] nyb[2] nye[2]
...
m[No] nxb[No] nxe[No] nyb[No] nye[No]
```

Расшифровка:

- `radius` — радиус квадранта окружности;
- `square_size` — размер внутреннего квадрата;
- `Kx Ky` — количество координатных линий по x и y внутри квадрата;
- далее `Ky` строк по `2*Kx` чисел — координаты узлов прямоугольной сетки на квадрате;
- `No` — число подобластей;
- строка `m nxb nxe nyb nye` — описание подобласти:
  - `m[k]` — номер материала;
  - `nxb, nxe` —  номера начальной и конечной координатной линии по x;
  - `nyb, nye` — номера начальной и конечной координатной линии по y.

## Формат выходного файла сетки

### Готовая сетка — `radial_mesh.txt`

Генератор записывает сетку в формате:

```text
NODES
<N>
id_0 x_0 y_0
...
id_{N-1} x_{N-1} y_{N-1}

ELEMENTS
<M>
e_0 n1 n2 n3 n4 mat
...
e_{M-1} n1 n2 n3 n4 mat
```

- `N` — число узлов;
- `M` — число четырёхугольных элементов;
- `id_i` — номер узла;
- `x_i, y_i` — координаты узла;
- `e_k` — номер элемента;
- `n1..n4` — номера его вершин;
- `mat` — номер материала/подобласти (`1` для квадрата, `2` для кольцевой части).

## Реализация алгоритма

Генератор `mesh_generator.py` реализует схему из аглоритма построения сетки:

1. **Чтение описания области** — функция `read_area_file`:
   - читает `radius`, `square_size`;
   - читает `Kx`, `Ky` и координатные линии прямоугольной сетки;
   - считывает список подобластей.

2. **Формирование узлов квадрата**:
   - узлы базового прямоугольного блока `a × a` копируются в список `mesh.nodes`;
   - сохраняются их индексы для дальнейшего построения элементов.

3. **Построение узлов на дуге окружности**:
   - на правой стороне квадрата берутся точки `(x = a, y_i)`;
   - на каждом уровне `y_i` вычисляется соответствующий угол между `0` и `π/4` и точка на дуге `R`:
   - аналогично для верхней стороны квадрата `(x_j, y = a)` строятся узлы дуги между углами `π/4` и `π/2`.
   - координаты точки на дуге радиуса `R` задаются формулами  `x = R * cos(φ),  y = R * sin(φ)`.

4. **Радиальное разбиение** (`n_radial_div`, `spacing`):
   - между узлами на стороне квадрата и узлами на дуге для каждой координатной линии строятся промежуточные слои;
   - коэффициент разрядки `spacing` задаёт сгущение к квадрату или к дуге (`spacing` > 1 -> сгущение к квадрату; `spacing` < 1 -> сгущение к дуге;).

5. **Построение конечных элементов**:
   - на квадрате `a × a` элементы формируются по структуре прямоугольной сетки;
   - затем по радиальным полосам вдоль правой и верхней сторон квадрата формируются четырёхугольные элементы наружной области:
     - каждая полоса разбивается на `n_radial_div - 1`;
     - для каждой пары соседних линий строятся элементы `[n1, n2, n3, n4]`.

6. **Сохранение сетки** — функция `save_mesh_to_file` пишет файл `radial_mesh.txt` в формате NODES/ELEMENTS.

7. **Визуализация** — функция `visualize_radial_mesh`:
   - отображает узлы и четырёхугольные элементы;
   - отображает номера узлов.
